# –û—Ç—á–µ—Ç –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –±–∞–≥–∞—Ö –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ë–ê–ì–ò

### 1. XSS-—É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ `src/categories.js`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/categories.js:18, 21`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π) –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ HTML –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

**–£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞:**

1. **–°—Ç—Ä–æ–∫–∞ 18:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `label` –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ breadcrumbs
   ```javascript
   return `<span class="crumb ${active}" data-idx="${i}">${label}</span>${i<crumbs.length-1? '<span class="sep">‚Ä∫</span>':''}`;
   ```
   - –ï—Å–ª–∏ `c` (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏) —Å–æ–¥–µ—Ä–∂–∏—Ç HTML-—Ç–µ–≥–∏, –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
   - –ü—Ä–∏–º–µ—Ä: –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `<script>alert('XSS')</script>` –≤—ã–ø–æ–ª–Ω–∏—Ç JavaScript

2. **–°—Ç—Ä–æ–∫–∞ 21:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `name` –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   ```javascript
   const optionsHTML = list.map(([name,count])=>`<div class="category-item"><input type="checkbox" class="filter-checkbox" value="${name}"><span class="checkbox-text">${name}</span><span class="category-count">${count}</span></div>`).join('');
   ```
   - `${name}` –≤ –∞—Ç—Ä–∏–±—É—Ç–µ `value` - –≤–æ–∑–º–æ–∂–Ω–∞ XSS —á–µ—Ä–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞
   - `${name}` –≤ —Ç–µ–∫—Å—Ç–µ - –≤–æ–∑–º–æ–∂–Ω–∞ XSS —á–µ—Ä–µ–∑ HTML-—Ç–µ–≥–∏

**–ü—Ä–∏–º–µ—Ä —ç–∫—Å–ø–ª–æ–π—Ç–∞:**
–ï—Å–ª–∏ –≤ CSV –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—è: `"><img src=x onerror="alert('XSS')">`, —ç—Ç–æ –≤—ã–∑–æ–≤–µ—Ç XSS –∞—Ç–∞–∫—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `escapeHtml()` –∏ `escapeHtmlAttr()` –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

---

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `onerror` –∞—Ç—Ä–∏–±—É—Ç–∞ –≤ HTML

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `src/catalog.js:295`
- `src/catalog-enhanced.js:362`

**–ü—Ä–æ–±–ª–µ–º–∞:** –•–æ—Ç—è URL —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `onerror` —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π.

```javascript
const img = validatedImageUrl ? `<img src="${escapeHtmlAttr(validatedImageUrl)}" alt="${escapeHtmlAttr(p.name || '')}" loading="lazy" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">` : '';
```

**–†–∏—Å–∫:** 
- –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –∫—Ç–æ-—Ç–æ –∑–∞–±—É–¥–µ—Ç —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å URL, `onerror` –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è XSS
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —Å–ª–æ–∂–Ω–µ–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `addEventListener` –≤–º–µ—Å—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π –≤ HTML.

---

## üü° –°–†–ï–î–ù–ò–ï –ë–ê–ì–ò

### 3. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ —Å—Ç–∏–ª–µ–π –≤ `index.html`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `index.html:15-32, 156-165`

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ CSS –∏ JS —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–≤–∞–∂–¥—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ (v=21 –∏ v=22).

```html
<link rel="stylesheet" href="/src/styles.css?v=21" />
<!-- ... -->
<link rel="stylesheet" href="/src/styles.css?v=22" />
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä—É
- –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å—Ç–∏–ª–µ–π (–ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π)
- –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ —Å—Å—ã–ª–∫–∏ –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –≤–µ—Ä—Å–∏—é (–ø–æ—Å–ª–µ–¥–Ω—é—é v=22 –∏–ª–∏ –≤—ã—à–µ).

---

### 4. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `SHEET_CACHE_BUSTER`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `index.html:138-139`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã, –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ø–µ—Ä–≤–æ–µ.

```javascript
window.SHEET_CACHE_BUSTER = 'v=21';
window.SHEET_CACHE_BUSTER = 'v=22';
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ü–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—É –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–£–¥–∞–ª–∏—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –≤–µ—Ä—Å–∏—é.

---

### 5. –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `innerHTML` –≤ `ensureLoadMore()`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `src/catalog.js:317`
- `src/catalog-enhanced.js:415`

**–ü—Ä–æ–±–ª–µ–º–∞:** –•–æ—Ç—è –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `innerHTML` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª—É—á—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π.

```javascript
container.innerHTML = `<button id="load-more-btn" class="load-more-btn">–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë</button>`;
```

**–†–∏—Å–∫:**
- –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –∫—Ç–æ-—Ç–æ –¥–æ–±–∞–≤–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã
- –ú–µ–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ, —á–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ DOM API

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `createElement` –∏ `textContent` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏.

---

## üü¢ –ù–ò–ó–ö–ò–ï –ë–ê–ì–ò / –£–ª—É—á—à–µ–Ω–∏—è

### 6. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ñ–∞–π–ª `src/catalog.js`

**–ü—Ä–æ–±–ª–µ–º–∞:** 
–í –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞:
- `src/catalog.js` 
- `src/catalog-enhanced.js`

–û–±–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–ª–∞—Å—Å `TileCatalog`. –í `index.html` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `catalog-enhanced.js`. –§–∞–π–ª `catalog.js` –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ `catalog.js` –≥–¥–µ-–ª–∏–±–æ, –µ—Å–ª–∏ –Ω–µ—Ç - —É–¥–∞–ª–∏—Ç—å –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—É—Ç–∞–Ω–∏—Ü—ã.

---

### 7. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å CSP –∏ `unsafe-inline`

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `index.html:6`

**–ü—Ä–æ–±–ª–µ–º–∞:** Content Security Policy —Å–æ–¥–µ—Ä–∂–∏—Ç `'unsafe-inline'` –∏ `'unsafe-eval'`, —á—Ç–æ –æ—Å–ª–∞–±–ª—è–µ—Ç –∑–∞—â–∏—Ç—É.

```html
<meta http-equiv="Content-Security-Policy" content="... script-src 'self' 'unsafe-inline' 'unsafe-eval' ..." />
```

**–†–∏—Å–∫:**
- `unsafe-inline` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ inline —Å–∫—Ä–∏–ø—Ç–æ–≤ (XSS)
- `unsafe-eval` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `eval()` (–æ–ø–∞—Å–Ω–æ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–£–±—Ä–∞—Ç—å `unsafe-inline` –∏ `unsafe-eval`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nonce –∏–ª–∏ hash –¥–ª—è inline —Å–∫—Ä–∏–ø—Ç–æ–≤, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã.

---

### 8. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ CSV

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/catalog.js`, `src/catalog-enhanced.js`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ CSV —Ñ–∞–π–ª –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –æ—à–∏–±–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ CSV —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üìã –ò–¢–û–ì–û–í–´–ô –ü–†–ò–û–†–ò–¢–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. **–ö–†–ò–¢–ò–ß–ù–û** - –ò—Å–ø—Ä–∞–≤–∏—Ç—å XSS –≤ `categories.js` (–±–∞–≥ #1)
2. **–í–ê–ñ–ù–û** - –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ `index.html` (–±–∞–≥–∏ #3, #4)
3. **–í–ê–ñ–ù–û** - –ó–∞–º–µ–Ω–∏—Ç—å `onerror` –Ω–∞ `addEventListener` (–±–∞–≥ #2)
4. **–°–†–ï–î–ù–ï** - –£–ª—É—á—à–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `innerHTML` (–±–∞–≥ #5)
5. **–ù–ò–ó–ö–û** - –£–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ CSP (–±–∞–≥ #7)
6. **–ù–ò–ó–ö–û** - –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª—ã (–±–∞–≥ #6)

---

## ‚úÖ –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–°–æ–≥–ª–∞—Å–Ω–æ `BUGS_REPORT.md`, —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
- ‚úÖ XSS-—É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ `createProductCard` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtml`)
- ‚úÖ XSS-—É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `escapeHtmlAttr`)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (—Ñ—É–Ω–∫—Ü–∏—è `validateImageUrl`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏ (—Ö–æ—Ç—è –∏ —Å `unsafe-inline`)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á–µ—Ç–∞:** 2025-01-27
